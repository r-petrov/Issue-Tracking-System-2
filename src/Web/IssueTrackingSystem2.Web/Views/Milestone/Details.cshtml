@model MilestoneDetailsViewModel

@{
    ViewData["Title"] = "Milestone Details";
}

<h1>@ViewData["Title"]</h1>

<hr />
<div class="flex-elements">
    <div class="col-md-8">
        @if (this.User.IsInRole(GlobalConstants.AdministratorRoleName)
     || Model.Project.LeaderId == this.UserManager.GetUserId(this.User))
        {
            <div>
                <a asp-area=""
                   asp-controller=@ValuesConstants.MilestoneControllerName
                   asp-action=@ValuesConstants.UpdateActionName
                   asp-route-id="@Model.Id"
                   asp-route-leaderId="@Model.Project.LeaderId" class="btn btn-info button">
                    Update
                </a>
                <a asp-area=""
                   asp-controller=@ValuesConstants.IssueControllerName
                   asp-action=@ValuesConstants.CreateActionName
                   asp-route-milestoneId=@Model.Id
                   asp-route-leaderId="@Model.Project.LeaderId"
                   class="btn btn-success button">
                    Create Issue
                </a>
            </div>
        }

        <hr />
        <table class="table table-striped">
            <tr>
                <th>@nameof(MilestoneListViewModel.Title):</th>
                <td>@Model.Title</td>
            </tr>
            <tr>
                <th>@nameof(MilestoneListViewModel.StartDate).SplitStringByCapitalLetters():</th>
                <td>@Model.StartDate</td>
            </tr>
            <tr>
                <th>@nameof(MilestoneListViewModel.CompletionDate).SplitStringByCapitalLetters():</th>
                <td>@Model.CompletionDate</td>
            </tr>
            <tr>
                <th>@nameof(MilestoneListViewModel.Project)</th>
                <td>(Project ID: @Model.Project.Id) @Model.Project.Name</td>
            </tr>
            <tr>
                <th>@nameof(MilestoneListViewModel.Status)</th>
                <td>@Model.Status.Name</td>
            </tr>
        </table>
    </div>

    <hr />
    <h4>@($"{Model.Title}'s {nameof(Model.Issues)}")</h4>
    @if (Model.Issues != null && Model.Issues.Any())
    {
        <partial name="_IssuesPartial" model=@Model.Issues />

        if (Model.CompletedIssues != null && Model.CompletedIssues.Any())
        {
            <br />
            <h4>@($"{Model.Title}'s {nameof(Model.CompletedIssues)}")</h4>
            <partial name="_IssuesPartial" model=@Model.CompletedIssues />
        }
    }
    else
    {
        <p>
            @string.Format(
                format: MessagesConstants.StillNotAddedItems,
                arg0: GlobalConstants.Issues,
                arg1: Model.Title)
        </p>
    }
</div>
<div>
    <a asp-controller=@ValuesConstants.ProjectControllerName
       asp-action=@ValuesConstants.DetailsActionName
       asp-route-id=@Model.Project.Id>
        Back to List
    </a>
</div>
